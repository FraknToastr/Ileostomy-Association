<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ileostomy Association Calendar</title>
<style>
  :root { --accent1:#667eea; --accent2:#764ba2; --overlay:rgba(0,0,0,.45); }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;
    background:linear-gradient(135deg,var(--accent1) 0%,var(--accent2) 100%);
    min-height:100vh;padding:6px;
  }
  .container{max-width:1200px;margin:0 auto;background:#fff;border-radius:12px;
    box-shadow:0 10px 30px rgba(0,0,0,.25);overflow:hidden;}
  .header{background:linear-gradient(135deg,var(--accent1) 0%,var(--accent2) 100%);
    color:#fff;padding:14px;text-align:center;}
  .header h1{font-size:1.6em;margin-bottom:4px;}
  .main-content{display:flex;flex-wrap:wrap;}
  .sidebar{width:250px;background:#f8f9fa;padding:14px;border-right:1px solid #e0e0e0;}
  .sidebar h2{color:var(--accent1);font-size:1.15em;margin-bottom:10px;}
  .filter-btn,.today-btn{border-radius:8px;border:none;font-size:.9em;transition:.3s;}
  .today-btn{width:100%;padding:11px;background:linear-gradient(135deg,var(--accent1),var(--accent2));
    color:#fff;font-weight:bold;margin-bottom:14px;}
  .today-btn:hover{transform:translateY(-2px);box-shadow:0 3px 10px rgba(102,126,234,.4);}
  .filter-group{display:flex;flex-direction:column;gap:6px;}
  .filter-row{display:flex;align-items:center;gap:6px;}
  .filter-btn{flex:1;display:flex;align-items:center;justify-content:flex-start;
    padding:8px 11px;border:1px solid #ddd;background:#fff;cursor:pointer;}
  .filter-btn:hover{transform:translateX(4px);box-shadow:0 3px 8px rgba(0,0,0,.1);}
  .filter-btn.active{background:var(--accent1);color:#fff;border-color:var(--accent1);}
  .color-indicator{width:15px;height:15px;margin-right:6px;border-radius:3px;
    border:1px solid rgba(0,0,0,.1);}
  .next-bbq-btn{padding:6px 10px;border:none;border-radius:6px;
    background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#fff;
    font-size:.8em;cursor:pointer;white-space:nowrap;}
  .next-bbq-btn:hover{opacity:.9;transform:translateY(-1px);}
  .calendar-section{flex:1;padding:10px;}
  .calendar-nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}
  .calendar-nav button{background:var(--accent1);color:white;border:none;padding:7px 13px;
    border-radius:6px;font-size:.9em;cursor:pointer;transition:.3s;}
  .calendar-nav button:hover{background:var(--accent2);}
  .calendar-nav h2{color:#333;font-size:1.3em;}
  .calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;}
  .day-header{text-align:center;font-weight:700;color:var(--accent1);
    background:#f8f9fa;border-radius:6px;font-size:1.6em;padding:10px 4px;}
  .day{border:1px solid #e0e0e0;border-radius:6px;padding:2px 3px;display:flex;
    flex-direction:column;justify-content:space-between;transition:.25s;background:#fff;min-height:55px;}
  .day:hover{transform:scale(1.03);box-shadow:0 4px 8px rgba(0,0,0,.15);}
  .day.other-month{opacity:.3;}
  .day-number{font-size:.9em;font-weight:bold;}
  .day-events{font-size:.8em;font-weight:600;margin-top:auto;line-height:1.3em;
    display:flex;align-items:center;gap:4px;flex-wrap:wrap;}
  .day-events .emoji{font-size:1.5em;line-height:1em;}
  .day.open-day,.day.clinic-day{background:linear-gradient(135deg,#84fab0 0%,#8fd3f4 100%);}
  .day.bbq-day{background:linear-gradient(135deg,#ffd93d 0%,#ff6b35 100%);}
  .day.agm-day{background:linear-gradient(135deg,#99f2c8 0%,#f9f586 50%,#f6d365 100%);
    color:#222;text-shadow:0 0 6px rgba(255,255,255,0.6);}
  .day.admin-day{background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);}
  .day.closure-day{background:linear-gradient(135deg,#ff6b6b 0%,#c92a2a 100%);color:white;}
  .day.today{border:3px solid var(--accent1);box-shadow:0 0 6px rgba(102,126,234,0.6);}
  .day.hidden{opacity:.15;pointer-events:none;}
  .agm-label{position:relative;display:inline-block;}
  .agm-label::after{content:"";position:absolute;left:0;bottom:-2px;width:100%;height:2px;
    background:linear-gradient(90deg,#fff176,#f57c00);animation:agm-underline 2s infinite alternate;}
  @keyframes agm-underline{from{transform:scaleX(0);opacity:.3;}to{transform:scaleX(1);opacity:1;}}
  @media(max-width:600px){
    .day-header{font-size:1em;padding:6px 2px;}
    .day-number{font-size:.7em;}
    .day-events{font-size:.6em;}
    .day-events .emoji{font-size:1em;}
    .calendar-nav h2{font-size:1em;}
    .today-btn,.filter-btn{font-size:.8em;padding:6px;}
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>üè• Ileostomy Association Calendar</h1>
    <p>Supporting our community with care and compassion</p>
  </div>
  <div class="main-content">
    <div class="sidebar">
      <h2>Filter Events</h2>
      <button class="today-btn" id="todayBtn">üìÖ Back to Today</button>
      <div class="filter-group">
        <button class="filter-btn" data-filter="open"><span class="color-indicator"
          style="background:linear-gradient(135deg,#84fab0 0%,#8fd3f4 100%)"></span>üè† Open</button>
        <button class="filter-btn" data-filter="clinic"><span class="color-indicator"
          style="background:linear-gradient(135deg,#84fab0 0%,#8fd3f4 100%)"></span>üë©‚Äç‚öïÔ∏è Open/Clinic</button>
        <div class="filter-row">
          <button class="filter-btn" data-filter="bbq">
            <span class="color-indicator" style="background:linear-gradient(135deg,#ffd93d,#ff6b35)"></span>üçî Paul Martin BBQ
          </button>
          <button class="next-bbq-btn" id="nextBBQ">Next ‚Üí</button>
        </div>
        <button class="filter-btn" data-filter="agm"><span class="color-indicator"
          style="background:linear-gradient(135deg,#99f2c8,#f6d365)"></span>üßæ AGM</button>
        <button class="filter-btn" data-filter="admin"><span class="color-indicator"
          style="background:linear-gradient(135deg,#ffecd2,#fcb69f)"></span>üò¥ Closed/Admin Day</button>
        <button class="filter-btn" data-filter="closure"><span class="color-indicator"
          style="background:linear-gradient(135deg,#ff6b6b,#c92a2a)"></span>üéÖ Holiday Closure</button>
      </div>
    </div>
    <div class="calendar-section">
      <div class="calendar-nav">
        <button id="prevMonth">‚Üê Prev</button>
        <h2 id="monthYear"></h2>
        <button id="nextMonth">Next ‚Üí</button>
      </div>
      <div class="calendar" id="calendar"></div>
    </div>
  </div>
</div>

<script>
let currentDate=new Date();
const filters={open:false,clinic:false,bbq:false,agm:false,admin:false,closure:false};
const AGM_DATE=new Date(2025,8,15);
const dayHeaders=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
const emojiMap={open:"üè†",clinic:"üë©‚Äç‚öïÔ∏è",bbq:"üçî",agm:"üßæ",admin:"üò¥",closure:"üéÖ"};

function isOpenDay(d){const g=d.getDay(),dom=d.getDate();
  if(g===4||g===0)return false;
  if(g===6){const w=Math.ceil(dom/7);return!(w===2||w===4);}
  return [1,2,3,5].includes(g);}
function isBBQDay(d){const m=d.getMonth(),g=d.getDay(),dom=d.getDate();
  return g===0&&dom<=7&&[0,3,6,9].includes(m);}
const isAGMDay=d=>d.toDateString()===AGM_DATE.toDateString();
const isAdminDay=d=>{const g=d.getDay(),dom=d.getDate(),w=Math.ceil(dom/7);
  return g===4||g===0||(g===6&&(w===2||w===4));};
function isClosureDay(d){const m=d.getMonth(),dom=d.getDate();
  return (m===11&&dom>=25)||(m===0&&dom<=2);}

function getEventTypes(date){
  const types=[];
  if(isClosureDay(date))types.push("closure");
  if(isAGMDay(date))types.push("agm");
  if(isBBQDay(date))types.push("bbq");
  if(isAdminDay(date))types.push("admin");
  if(isOpenDay(date)){
    const g=date.getDay();
    if(g===1||g===3)types.push("open","clinic"); else types.push("open");
  }
  return [...new Set(types)];
}

function getEventLabel(types,date){
  if(types.includes("bbq"))return"Paul Martin BBQ";
  if(types.includes("closure"))return"Closed (Holiday)";
  if(types.includes("admin")){const g=date.getDay();return g===4?"Closed/Admin Day":"Closed";}
  if(types.includes("clinic"))return"Open/Clinic";
  if(types.includes("open"))return"Open";
  if(types.includes("agm"))return"AGM";
  return"";
}
function findNextBBQMonth(){
  for(let off=1;off<=12;off++){
    const test=new Date(currentDate);test.setMonth(currentDate.getMonth()+off);
    const days=new Date(test.getFullYear(),test.getMonth()+1,0).getDate();
    for(let d=1;d<=days;d++){
      const dt=new Date(test.getFullYear(),test.getMonth(),d);
      if(getEventTypes(dt).includes("bbq"))return test;
    }
  }
  return null;
}
function renderCalendar(){
  const y=currentDate.getFullYear(),m=currentDate.getMonth(),today=new Date();
  document.getElementById("monthYear").textContent=currentDate.toLocaleDateString("en-US",{month:"long",year:"numeric"});
  const first=new Date(y,m,1).getDay(),daysIn=new Date(y,m+1,0).getDate(),prevDays=new Date(y,m,0).getDate();
  const cal=document.getElementById("calendar");cal.innerHTML="";
  dayHeaders.forEach(d=>{const h=document.createElement("div");h.className="day-header";h.textContent=d;cal.appendChild(h);});
  const renderDay=(date,off=0)=>{
    const types=getEventTypes(date),label=getEventLabel(types,date),cls=["day"];
    if(types.includes("closure"))cls.push("closure-day");
    else if(types.includes("agm"))cls.push("agm-day");
    else if(types.includes("bbq"))cls.push("bbq-day");
    else if(types.includes("admin"))cls.push("admin-day");
    else if(types.includes("clinic"))cls.push("clinic-day");
    else if(types.includes("open"))cls.push("open-day");
    if(off!==0)cls.push("other-month");
    if(date.toDateString()===today.toDateString())cls.push("today");
    if(Object.values(filters).some(v=>v)&&(!types.some(t=>filters[t])))cls.push("hidden");
    let emojiHTML="";
    if(types.includes("closure"))emojiHTML=`<span class='emoji'>${emojiMap["closure"]}</span>`;
    else if(types.includes("bbq"))emojiHTML=`<span class='emoji'>${emojiMap["bbq"]}</span>`;
    else emojiHTML=types.map(t=>`<span class='emoji'>${emojiMap[t]||""}</span>`).join(" ");
    const labelHTML=label==="AGM"?`<span class="agm-label">${label}</span>`:label;
    const day=document.createElement("div");
    day.className=cls.join(" ");
    day.innerHTML=`<div class="day-number">${date.getDate()}</div>${label?`<div class="day-events">${emojiHTML} ${labelHTML}</div>`:""}`;
    return day;
  };
  for(let i=first-1;i>=0;i--)cal.appendChild(renderDay(new Date(y,m-1,prevDays-i),-1));
  for(let i=1;i<=daysIn;i++)cal.appendChild(renderDay(new Date(y,m,i),0));
  const total=cal.children.length-7;
  for(let i=1;i<=42-total-7;i++)cal.appendChild(renderDay(new Date(y,m+1,i),1));
}
document.getElementById("prevMonth").onclick=()=>{currentDate.setMonth(currentDate.getMonth()-1);renderCalendar();};
document.getElementById("nextMonth").onclick=()=>{currentDate.setMonth(currentDate.getMonth()+1);renderCalendar();};
document.getElementById("todayBtn").onclick=()=>{
  currentDate=new Date();for(const f in filters)filters[f]=false;
  document.querySelectorAll(".filter-btn").forEach(b=>b.classList.remove("active"));renderCalendar();
};
document.querySelectorAll(".filter-btn").forEach(btn=>{
  const f=btn.dataset.filter;
  btn.addEventListener("click",()=>{
    filters[f]=!filters[f];
    btn.classList.toggle("active");
    renderCalendar(); // only toggle for current month
  });
});
document.getElementById("nextBBQ").onclick=()=>{
  const match=findNextBBQMonth();
  if(match){currentDate=match;renderCalendar();}
};
renderCalendar();
</script>
</body>
</html>
